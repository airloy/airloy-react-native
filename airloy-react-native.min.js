import{Device as e,Event as t,Store as n}from"airloy";import{AsyncStorage as r,Platform as i,RCTDeviceEventEmitter as o}from"react-native";function __async(e){return new Promise(function(t,n){function r(o,u){try{var a=e[u?"throw":"next"](o)}catch(e){n(e);return}a.done?t(a.value):Promise.resolve(a.value).then(r,i)}function i(e){r(e,1)}r()})}var asyncGenerator=function(){function e(e){this.value=e}function t(t){var n,r;function i(e,t){return new Promise(function(i,u){var a={key:e,arg:t,resolve:i,reject:u,next:null};if(r){r=r.next=a}else{n=r=a;o(e,t)}})}function o(n,r){try{var i=t[n](r);var a=i.value;if(a instanceof e){Promise.resolve(a.value).then(function(e){o("next",e)},function(e){o("throw",e)})}else{u(i.done?"return":"normal",i.value)}}catch(e){u("throw",e)}}function u(e,t){switch(e){case"return":n.resolve({value:t,done:true});break;case"throw":n.reject(t);break;default:n.resolve({value:t,done:false});break}n=n.next;if(n){o(n.key,n.arg)}else{r=null}}this._invoke=i;if(typeof t.return!=="function"){this.return=undefined}}if(typeof Symbol==="function"&&Symbol.asyncIterator){t.prototype[Symbol.asyncIterator]=function(){return this}}t.prototype.next=function(e){return this._invoke("next",e)};t.prototype.throw=function(e){return this._invoke("throw",e)};t.prototype.return=function(e){return this._invoke("return",e)};return{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}();var classCallCheck=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();var get=function e(t,n,r){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,n);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,n,r)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(r)}};var inherits=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t};var possibleConstructorReturn=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e};var set=function e(t,n,r,i){var o=Object.getOwnPropertyDescriptor(t,n);if(o===undefined){var u=Object.getPrototypeOf(t);if(u!==null){e(u,n,r,i)}}else if("value"in o&&o.writable){o.value=r}else{var a=o.set;if(a!==undefined){a.call(i,r)}}return r};var NativeDevice=function(e){inherits(t,e);function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n._init();return n}createClass(t,[{key:"_init",value:function e(){return __async(function*(){var e=yield yield r.getItem("airloy.device.id");if(e){this._identifier=e}else{this._identifier=i.OS+"^react-native^"+this.createGuid();r.setItem("airloy.device.id",this._identifier)}}.call(this))}},{key:"createGuid",value:function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e==="x"?t:t&3|8;return n.toString(16)})}},{key:"getIdentifier",value:function e(){return this._identifier}}]);return t}(e);var NativeEvent=function(e){inherits(t,e);function t(){classCallCheck(this,t);return possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}createClass(t,[{key:"on",value:function e(t,n){o.addListener(t,n)}},{key:"once",value:function e(t,n){o.once(t,n)}},{key:"_off",value:function e(t){o.removeAllListeners(t)}},{key:"emit",value:function e(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++){r[i-1]=arguments[i]}o.emit.apply(o,[t].concat(r))}}]);return t}(t);var NativeStore=function(e){inherits(t,e);function t(){classCallCheck(this,t);return possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}createClass(t,[{key:"getItem",value:function e(t){return __async(function*(){var e=yield r.getItem(t);return e}())}},{key:"setItem",value:function e(t,n){r.setItem(t,n)}},{key:"removeItem",value:function e(t){r.removeItem(t)}}]);return t}(n);var plugin={install:function e(t){t.store=new NativeStore;t.device=new NativeDevice;t.event=new NativeEvent}};export default plugin;